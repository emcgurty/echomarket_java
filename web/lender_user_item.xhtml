<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
  template="./UserDetailTemplate.xhtml">

  <ui:define name="header"  >
    <ui:include rendered="true" src="application_header.xhtml" id="LoginHeader" /> 
  </ui:define>  

  <ui:define name="content">

    <h:form id="item_content" enctype="multipart/form-data" >
      <ui:include rendered="true" src="dumbyDiv.xhtml" id="dumbyDiv" /> 
      
      <div id="form_item" class="contact_information" >
        <div class="message.color">
          <h:messages showSummary="true" 
                      showDetail="false"
                      errorStyle="color: #d20005" 
                      infoStyle="color: blue"/>
        </div>

        <ui:include rendered="true" src="/user_detail_menu.xhtml" id="menu_in_item" ></ui:include>  
        <div class="top" >
          <div >
            <h:outputText value="NEW ITEM"  />
            <h:outputText value="#{userBean.itemId}"  />
            <h:commandLink  action="#{itemBean.saveItem()}"  class="right_div" value="Save New Item"  rendered="#{userBean.editable == 1}" />
            <h:commandLink  action="#{itemBean.load_ud(itemBean.itemType, itemBean.itemId)}"  class="right_div" value="Edit Item"  rendered="#{userBean.editable == 0}" />

          </div> 
        </div> 

        <div  class="div_p" id="menu_item_3" >
          <div style="margin:10px;" >

            <h:outputText value="The Item you would like to Lend}" rendered="#{itemBean.itemType ne 'both'}"/>
            <h:outputText value="The Item you would like to... Please select: " rendered="#{itemBean.itemType == 'both'}"/>
            <h:selectOneMenu id="which_type" value="#{itype}" rendered="#{itemBean.itemType == 'both'}" >
              <f:selectItem itemValue="0" itemLabel="borrow" />	
              <f:selectItem itemValue="1" itemLabel="lend" />
            </h:selectOneMenu>    
          </div>
        </div>

        <div  class="div_p"  >
          <div style="margin:10px;" >
            <h:outputText value="Item Detail..." />
            <h:inputText id="itemType" value="#{itemBean.itemType}"  style="display:none;" />
            <h:inputText id="itemId" value="#{itemBean.itemId}"  style="display:none;" />
            <h:inputText id="participant_id" value="#{itemBean.participant_id}"  style="display:none;" />
          </div>
        </div>

        <table >
          <tr class="odd">
            <td style="width:50%;">
              <div style="margin-left:25px;margin-top:5px;">
                <h:outputLabel for="categoryId" value="Category:" ><span class="required_fields">*</span>
                  <h:selectOneMenu id="categoryId" value="#{itemBean.categoryId}"  style="margin-left:10px"  class="items select"   rendered="#{userBean.editable == 1}">
                    <f:selectItems id="category_id_value" value="#{cats.buildCatArray()}"   var="c"
                                   itemLabel="#{c.categoryType}" itemValue="#{c.id}" >
                    </f:selectItems>
                  </h:selectOneMenu>
                  <h:outputText  id="categoryIdString" value="#{cats.getCategoryName(itemBean.categoryId)}"   rendered="#{userBean.editable == 0}" class="RO_text"/>
                </h:outputLabel>  
                <br /><span class="error-message" id="categoryId" ></span>
              </div>
            </td>
            <td style="width:50%;">

              <div id="other_category" style="display:none;">    
                <h:outputLabel for="otherItemCategory" value="Add another category:" ><span class="required_fields">*</span>
                  <h:inputText  value="#{itemBean.otherItemCategory}" id="otherItemCategory"  class="items"  style="margin-left:10px"    rendered="#{userBean.editable == 1}"/>
                  <h:outputText  id="otherItemCategoryString" value="#{itemBean.otherItemCategory}"   rendered="#{userBean.editable == 0}"/>
                </h:outputLabel>    
                <span class="error-message" id="otherItemCategory" ></span>
              </div>
            </td>
          </tr>

          <tr class="even">
            <td colspan='2'>
              <div style="margin-left:25px;margin-top:5px;">
                <h:outputLabel value="#{bundle.BasedOnB}"  for="notify" >
                  <h:selectOneRadio id="notify" value="#{itemBean.notify}"   rendered="#{userBean.editable == 1}" >
                    <f:selectItem itemValue="1" itemLabel="Yes" />
                    <f:selectItem itemValue="0" itemLabel="No" />	
                  </h:selectOneRadio>    
                  <c:if test="#{userBean.editable == 0}" >
                    <c:choose>
                      <c:when test="#{itemBean.notify == 0}">
                        <c:set var="cbe" value="No"/>
                      </c:when>
                      <c:when test="#{itemBean.notify == 1}">
                        <c:set var="cbe" value="Yes"/>
                      </c:when>
                      <c:otherwise>
                        <c:set var="cbe" value="No preference provided"/>
                      </c:otherwise>
                    </c:choose>
                    <h:outputText id="notifyString"   value="#{cbe}" class="RO_text" />
                  </c:if>  
                </h:outputLabel>                        

              </div></td>
          </tr>

          <tr class="odd">
            <td style="width:50%">
              <div style="margin-left:25px;margin-top:5px;">
                <h:outputLabel for="itemDescription" value="#{bundle.ItemDescription}" ><span class="required_fields">*</span>
                  <h:inputText  id="itemDescription" value="#{itemBean.itemDescription}" class="items"  style="margin-left:10px"   rendered="#{userBean.editable == 1}"/>
                  <h:outputText  value="#{itemBean.itemDescription}"    rendered="#{userBean.editable == 0}"  class="RO_text"/>
                </h:outputLabel>
                <span class="error-message" id="itemDescription" ></span>
              </div></td>
            <td style="width:50%">
              <div style="margin-left:25px;margin-top:5px;">
                <h:outputLabel value="#{bundle.ItemCondition}" for="itemConditionId"  ><span class="required_fields">*</span>
                  <h:selectOneMenu id="itemConditionId" value="#{itemBean.itemConditionId}"  style="margin-left:10px" class="items select"   rendered="#{userBean.editable == 1}">
                    <f:validator validatorId="selectOneMenuValidator" />  
                    <f:selectItems id="item_condition" value="#{itemc.buildItemConditionsArray()}"  
                                   var="c" itemValue="#{c.id}" itemLabel="#{c.condition}" 
                                   >   
                    </f:selectItems>    
                  </h:selectOneMenu>
                  <c:if test="#{userBean.editable == 0}" >
                    <c:set var="icn" value="#{itemc.getItemConditionName(itemBean.itemConditionId)}" />
                    <h:outputText  id="itemConditionIdString" value="#{icn}" class="RO_text"/>
                  </c:if>
                </h:outputLabel>
                <br /> <span class="error-message" id="itemConditionId" ></span>
              </div></td>
          </tr>

          <tr class="even">
            <td  style="width:50%;">
              <div style="margin-left:25px;margin-top:5px;">
                <h:outputLabel for="itemModel" value="#{bundle.ItemModel}" >
                  <h:inputText id="itemModel" value="#{itemBean.itemModel}"  style="margin-left:10px"   rendered="#{userBean.editable == 1}"/>
                  <h:outputText  id="itemModelString" value="#{itemBean.itemModel}"   rendered="#{userBean.editable == 0}" class="RO_text"/>
                </h:outputLabel>
              </div></td>
            <td  style="width:50%;">
              <div style="margin-left:25px;margin-top:5px;">
                <h:outputLabel for="itemCount" value="#{bundle.NumberOfItems}" ><span class="required_fields">*</span>
                  <h:inputText  id="itemCount" value="#{itemBean.itemCount}" size="2" maxlength="2" required="true" class="items"  style="margin-left:10px"   rendered="#{userBean.editable == 1}"/>
                  <h:outputText  id="itemCountString" value="#{itemBean.itemCount}"   rendered="#{userBean.editable == 0}" class="RO_text"/>
                </h:outputLabel>
                <span class="error-message" id="itemCount" ></span>
              </div></td>
          </tr>
        </table>
        <br />
        <div style="margin-left:25px;margin-top:5px;float:left;">
          <h:outputText value="HERE "  />
          <h:outputText value="#{userBean.itemId}"  />
          <h:dataTable id="picture"  value="#{itemBean.getCurrentItemImage(userBean.itemId)}" var="image"   rendered="#{userBean.editable == 1}" >
            <h:column rowHeader="">
              <div style="margin-left:25px;margin-top:5px;float:left;">
                <h:outputLabel for="imageFileNamePart" value="Image of Item" >    
                  <h:inputFile id="imageFileNamePart" value="#{itemBean.imageFileNamePart}" />
                  <span class="file_image_error"></span>
                </h:outputLabel>
                <br />
                <input type="button" onclick="removeImage()" alt="Click to remove selected image.."  value="Remove Image" ></input>
              </div>    
              <br />
              <div style="margin-left:5px;margin-top:5px;float:left;display:block;" id="image_details">
                <h:outputLabel for="imagePreview" value="Uploaded Image:"  >
                  <h:graphicImage  id="imagePreview" name="#{image.imageFileName}" library="lend_images" alt="Item Image"   height="100" width="100" rendered="#{!empty image.imageFileName}"/>
                </h:outputLabel> 
              </div>
              <br />
              <div style="margin-left:25px;margin-top:15px;float:left;display:block;" >
                <h:outputLabel for="itemImageCaption" value="If you'd like, provide a caption for your item image:" >
                  <h:inputText  id="itemImageCaption" value="#{image.itemImageCaption}" size="50" maxlength="50" style="margin-left:10px" />
                </h:outputLabel>
              </div>
            </h:column>
          </h:dataTable>
        
          <h:dataTable id="pictureRO"  value="#{itemBean.getCurrentItemImage(userBean.itemId)}" var="image"   rendered="#{userBean.editable == 0}">
            <h:column rowHeader="">
              <div style="margin-left:5px;margin-top:5px;float:left;display:block;" id="image_details">
                <h:outputLabel for="viewImage" value="Uploaded Image:"  >
                  <h:inputHidden id="image_directory" value="${'lend_images'}" rendered="true"/>
                  <c:set var="foundImageFileName" value="${image.imageFileName}" rendered="true"/>
                  <h:inputHidden id="image_name" value="${foundImageFileName}" rendered="true"/>
                  <img id="viewImage"  src=""/>
                </h:outputLabel> 
              </div>
              <br />
              <div style="margin-left:25px;margin-top:15px;float:left;display:block;" >
                <h:outputLabel for="itemImageCaption" value="Provided caption for your item image:" >
                  <h:outputText  id="itemImageCaption" value="#{image.itemImageCaption}" class="RO_text" />
                </h:outputLabel>
              </div>
            </h:column>
          </h:dataTable>

        </div>

      </div>
    </h:form>
  </ui:define>

  <ui:define name="footer"  >
    <ui:include rendered="true" src="application_footer.xhtml" id="LoginFooter" /> 
  </ui:define>

</ui:composition>