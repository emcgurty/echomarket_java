<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                template="./echomarketTemplate.xhtml">


    <ui:define name="header"  >
        <ui:include rendered="true" src="application_header.xhtml" id="SearchHeader" /> 
    </ui:define>

    <ui:define name="content">

        <h:form id="search_items">
            <h:head>
                <h:outputScript library="javascript" name="item_search.js"  />
                <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
                <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
                <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
            </h:head>
            <ui:include rendered="true" src="dumbyDiv.xhtml" id="dumbyDiv" /> 
                       <div class="top" >
                <div style="margin:10px;margin-top:25px;margin-right:15px;" >
                    <h:outputText value="BORROWER OR LENDER ITEM SEARCH"  />
                    
                    <h:commandLink  action="#{search.SearchResults()}"  class="right_div" value="Fingers Crossed! Submit search." onclick="if(!submitSearch()){return false;}"/>

                </div> 
            </div> 


            <div  style="float:left;margin-top:5px;margin-left:15px;background-color: azure; width:90%; padding: 10px;font-weight: 700">

                <h:outputLabel value="SEARCH items to borrow or items to lend?:"  for="lenderOrBorrower" >
                    <h:selectOneRadio id="lenderOrBorrower"  value="#{search.lenderOrBorrower}" layout='lineDirection' required="true">
                        <f:selectItem itemValue="1" itemLabel="What have LENDERS offered:" />
                        <f:selectItem itemValue="2" itemLabel="What have BORROWERS sought:" />
                    </h:selectOneRadio>    
                    <h:message styleClass="error-message" for="lenderOrBorrower"/>
                </h:outputLabel>   


            </div>


            <div  style="float:left;margin-top:5px;margin-left:15px;background-color: white; width:45%; padding: 10px;">

                <h:outputLabel value="By Item Description or Model:" for="keyword" >
                    <h:inputText  id="keyword"  value="#{search.keyword}" class="search" style="margin-left:10px;" required="false"/>
                    <h:message styleClass="error-message" for="keyword"/>
                </h:outputLabel>
                <br />
                <span class="radius" >Use one singular noun or verb to describe an item, you can use a partial word.</span>
            </div>

            <div  style="float:left;margin-top:5px;margin-left:15px;background-color: white; width:45%; padding: 10px;">

                <h:outputLabel for="categoryId" value="By Item category:" >
                    <h:selectOneMenu id="categoryId"  value="#{search.categoryId}" style="margin-left:10px;" required="false">
                        <f:selectItems id="category_id_value" value="#{cats.buildCatArray()}"   var="c" itemLabel="#{c.categoryType}" itemValue="#{c.id}" >
                        </f:selectItems>
                        <h:message styleClass="error-message" for="categoryId"/>
                    </h:selectOneMenu>
                </h:outputLabel>  

            </div>

            <div  style="float:left;margin-top:5px;margin-left:15px;background-color: azure; width:90%; padding: 10px;">
                <label>By Date Created Range:</label>

                <table class="search">
                    <tr>
                        <td style="text-align:left;font-size:12px;width:40%;">Start Date</td>
                        <td style="text-align:left;font-size:12px;width:20%;">- through - </td>
                        <td style="text-align:left;font-size:12px;width:40%;">End Date</td>
                    </tr>
                    <tr>
                        <td>
                            <h:inputText  id="startDate" value="#{search.startDate}"   required="false"/>
                            <h:message styleClass="error-message" for="startDate"/>
                        </td>
                        <td></td>
                        <td>
                            <h:inputText  id="endDate" value="#{search.endDate}"    required="false"/>
                            <h:message styleClass="error-message" for="endDate"/>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="error-message" id="start_date_error"></span></td>
                        <td></td>
                        <td><span class="error-message" id="end_date_error"></span></td>
                    </tr>
                </table>
            </div>

            <div  class="location" style="float:left;">
                <div  style="float:left;margin-top:5px;margin-left:15px;background-color: white; width:45%; padding: 10px;">
                    <h:outputLabel value="By Postal Code Location:" for="postalCode"  >
                        <h:inputText  id="postalCode" class="search"  value="#{search.postalCode}" style="margin-left:10px;" required="false"/>
                        <br />
                        <h:message styleClass="error-message" for="postalCode"/>
                        <span class="error-message" id="postal_code_location_error"></span>
                    </h:outputLabel>

                    <span class="radius" style="float:left;">You can search for vicinity postal code beginning with a certain pattern.  For example to find all items in the Boston, MA area, just search for '021' without the single quotes.</span>
                </div>

                <div  style="float:left;margin-top:5px;margin-left:15px;background-color: white; width:45%; padding: 10px;">
                    <h:outputLabel value="Within Radius:"  for="zip_code_radius" >
                        <br />
                        <h:outputLabel value="Select number of miles from your entered postal code."   />
                        <h:selectOneRadio id="zip_code_radius"  layout='lineDirection' required="false">
                            <f:selectItem itemValue="1" itemLabel="One Mile:" />
                            <f:selectItem itemValue="5" itemLabel="Five Miles:" />
                            <f:selectItem itemValue="10" itemLabel="Ten Miles:" />
                            <f:selectItem itemValue="25" itemLabel="25 Miles:" />

                        </h:selectOneRadio>    
                    </h:outputLabel>   

                    <h:outputLabel value="Postal Codes found within radius:" for="postal_code" >
                        <h:inputText  id="found_zip_codes" value="#{search.found_zip_codes}" class="search" style="margin-left:10px;" required="false"/>
                    </h:outputLabel>
                    <span class="error-message" id="postal_code_error"></span>
                </div>

            </div>

            <div  style="float:left;margin-top:5px;width:100%;margin-left:15px;" >
                <span class="error-message" id="echo_market_search_error"></span>
            </div>



            <c:set var="currentSearchResult"  value="#{search.searchResultList}" />
            <c:set var="currentSearchCriteria"  value="#{search.searchCriteria }" />
            <h:outputText  id="asd" value="#{currentSearchCriteria}" style="margin-left:10px;color:black;"/>
            <div  style="float:left;margin-top:5px;width:100%;margin-left:15px;" >
                <h:outputLabel value="The results of your search criteria:" for="searchCriteria" rendered="${fn:length(currentSearchResult) > 0}" >
                    <h:outputText id="searchCriteria"  value="${currentSearchCriteria}" rendered="${fn:length(currentSearchResult) > 0}" />
                </h:outputLabel>
            </div>
            <h:dataTable id="item_search"  value="#{search.searchResultList}" var="var_search"  rendered="${fn:length(currentSearchResult) > 0}" >
                <h:column rowHeader="">
                    <div style="margin-left:25px;margin-top:15px;float:left;display:block;" >
                        <h:outputLabel for="itemDescription" value="Item Description:" >
                            <h:outputText  id="itemDescription" value="#{var_search.itemDescription}" style="margin-left:10px;color:black;"/>
                        </h:outputLabel>
                        <br />
                        <h:outputLabel for="itemModel" value="Item Model:" >
                            <h:outputText  id="itemModel" value="#{var_search.itemModel}" style="margin-left:10px;color:black;"/>
                        </h:outputLabel>
                        <br />

                    </div>
                </h:column>
            </h:dataTable>


            <h:panelGroup id="noRecordsFound" rendered="${search.displayResults}" >
                <div  style="float:left;margin-top:5px;width:100%;margin-left:25px;font-size:14x;color:#d20005 " >
                    <h:outputLabel value="The results of your search criteria:" for="searchCriteria2"  />
                    <h:outputText id="searchCriteria2"  value="${currentSearchCriteria}"  />
                    
                    <div  style="float:left;margin-top:5px;width:100%;margin-left:25px " >
                        <h:outputText value="Sorry, no Items were found." class="error-message"/>
                    </div>
                </div>

            </h:panelGroup>


        </h:form>
    </ui:define>

    <ui:define name="footer"  >
        <ui:include rendered="true" src="application_footer.xhtml" id="searchBorrowersFooter" /> 
    </ui:define>
</ui:composition>



