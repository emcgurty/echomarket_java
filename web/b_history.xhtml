<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                >

  <h:head>
    <c:set var="currentHistory"  value="#{itemBean.getParticipantItems(itemBean.history_id, 'borrow')}" />
    <c:set value="${fn:length(currentHistory) - 1}" var="sizeOfCurrentHistory" />

  </h:head>

  <h:form enctype="multipart/form-data" id="b_history" >
    <body  >
      <ui:include src="/item_menu.xhtml" id="borrowing_item_menu" />  
      <div class="top" style="margin-top:10px;"  >
        <h:outputText value="ITEMS SOUGHT TO BORROW" />
        <br />
        <div class="messagecolor">
          <h:messages showSummary="true" 
                      showDetail="false"
                      errorStyle="list-style-type:none;color: indigo" 
                      />
        </div>
      </div> 


      <c:forEach  items="#{currentHistory}" var="history" rendered="${fn:length(currentHistory) > 0}"  begin="0" end="${sizeOfCurrentHistory}">

        <div style="margin-left:25px;margin-top:15px;float:left;display:block;" >
          <h:outputLabel for="itemDescription" value="Item Description:" >
            <h:outputText  id="itemDescription" value="#{history[2]}" style="margin-left:10px;color:black;"/>
          </h:outputLabel>
          <br />
          <h:outputLabel for="itemModel" value="Item Model:" >
            <h:outputText  id="itemModel" value="#{history[3]}" style="margin-left:10px;color:black;"/>
          </h:outputLabel>
          <br />
          <h:outputLabel for="approved" value="Item Approved:" >
            <h:outputText  id="approved" value="Yes" style="margin-left:10px;color:black;" rendered="#{history[5] == 1}"  />
            <h:outputText  id="approved" value="No" style="margin-left:10px;color:black;" rendered="#{history[5] == 0}"  />
          </h:outputLabel>
          <br />
          <h:graphicImage name="#{history[0]}" library="borrow_images" alt="Item Image"   height="100" width="100" rendered="#{!empty history[0]}"/>
          <br />
          <h:commandButton value="Edit"  action="#{itemBean.load_ud('borrow', history[1])}" immediate="true" rendered="#{history[4] == userBean.participant_id}"  >
            <f:param name="action" value="item" />   
          </h:commandButton>    

          <h:commandButton value="Delete"  action="#{itemBean.deleteCurrentRecord(history[1], history[2])}"  immediate="true"  rendered="#{history[4] == userBean.participant_id}"  >
          </h:commandButton>    

        </div>
      </c:forEach>

      <div class="borrower_registration" >
        <h:outputText value="No Borrower History Records Found" rendered="${fn:length(currentHistory) == 0}" />
      </div>
    </body>
  </h:form>

</ui:composition>
