<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                >

  <h:form enctype="multipart/form-data" id="l_history"  >
    <ui:include src="/item_menu.xhtml" id="item_menu" />  
    <div class="top" >
      <h:outputText value="ITEMS OFFERED TO LEND"  />
    </div> 

    <c:set var="currentHistory"  value="#{itemBean.getParticipantItems(itemBean.history_id, 'lend')}" />

    <c:forEach  items="#{currentHistory}" var="history" rendered="${fn:length(currentHistory) > 0}" >
      <div style="margin-left:25px;margin-top:15px;float:left;position: relative;display:block;" >

        <h:outputLabel for="itemDescription" value="Item Description:" >
          <h:outputText  id="itemDescription" value="#{history.itemDescription}" style="margin-left:10px;color:black;"/>
        </h:outputLabel>
        <br />
        <h:outputLabel for="itemModel" value="Item Model:" >
          <h:outputText  id="itemModel" value="#{history.itemModel}" style="margin-left:10px;color:black;"/>
        </h:outputLabel>

        <h:dataTable id="image"  value="#{itemBean.getCurrentItemImage(history.itemId)}" var="i" >
          <h:column rowHeader="">
            <h:graphicImage name="#{i.imageFileName}" library="lend_images" alt="Item Image"   height="100" width="100" rendered="#{!empty i.imageFileName}"/>
          </h:column>
        </h:dataTable>
        <br />
        <h:commandButton value="Edit"  action="#{itemBean.load_ud('lend', history.itemId)}" immediate="true" rendered="#{history.participant_id == userBean.participant_id}"  >
          <f:param name="action" value="item" />     
        </h:commandButton>    

        <h:commandButton value="Delete"  action="#{itemBean.deleteCurrentRecord(history.itemId)}"  immediate="true"  rendered="#{history.participant_id == userBean.participant_id}"  >
        </h:commandButton>    


      </div>    
    </c:forEach>

    <div class="borrower_registration" >
      <h:outputText value="No Lender History Records Found" rendered="${fn:length(currentHistory) == 0}" />
    </div>
  </h:form>

</ui:composition>
