<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
  <h:head>
    <h:outputStylesheet library="css" name="item_nav.css"/>
  </h:head>
  <h:inputHidden id="acceptID" value="#{userBean.acceptID}"  />
  <h:inputHidden id="partID" value="#{userBean.partID}"  />
  <h:inputHidden id="cpId" value="#{userBean.cpId}"  />
  <h:inputHidden id="LITid" value="#{userBean.LITid}"  />
  <h:inputHidden id="LICid" value="#{userBean.LICid}"  />
  <c:set var="whichType" value="#{userBean.userType}" />
  <ul id="nav" class="item_menu" >

    <li class="subs"  >

      <c:choose>                                
        <c:when test="#{whichType == 'borrow'}"  >
          <li id="tab_item_1" >
            <h:commandLink immediate="true"  action="#{itemBean.load_ud('borrow', itemBean.itemId)}"  value="Item to Borrow: #{itemBean.itemDescription}"  rendered="#{!empty itemBean.itemDescription}"    >
              <f:param name="action" value="item" />             
            </h:commandLink>
            <h:commandLink immediate="true"  action="#{itemBean.load_ud('borrow', itemBean.itemId)}"  value="Item to Borrow"  rendered="#{empty itemBean.itemDescription}"    >
              <f:param name="action" value="item" />             
            </h:commandLink>
          </li>
        </c:when >  
        <c:when test="#{whichType == 'lend'}"  >
          <li id="tab_item_1" >
            <h:commandLink immediate="true"  action="#{itemBean.load_ud('lend',itemBean.itemId)}"  value="Item to Lend: #{itemBean.itemDescription}"  rendered="#{!empty itemBean.itemDescription}"    >
              <f:param name="action" value="item" />
            </h:commandLink>
            <h:commandLink immediate="true"  action="#{itemBean.load_ud('lend',itemBean.itemId)}"  value="Item to Lend: #{itemBean.itemDescription}"  rendered="#{empty itemBean.itemDescription}"    >
              <f:param name="action" value="item" />
            </h:commandLink>
          </li>
        </c:when >  
        <c:when test="#{whichType == 'both'}"  >
          <li id="tab_item_1" >
            <h:commandLink immediate="true"  action="#{itemBean.load_ud(whichType,itemBean.itemId)}"  value="New Item - #{userBean.getPrettyUserType()}"  style="text-transform: capitalize" rendered="true"    >
              <f:param name="action" value="item" />
            </h:commandLink>
          </li>
        </c:when >  
      </c:choose>
    </li>

    <c:choose>                                
      <c:when test="#{(whichType == 'borrow') and (!empty itemBean.itemId)}"  >
        <li id="tab_item_1">
          <c:set var="newItemLabel" value="Item Contact Preferences"  />
          <h:commandLink immediate="true"  action="#{contactPreferenceBean.load_ud(userBean.participant_id)}"  value="#{newItemLabel}"  >
            <f:param name="action" value="edit" />
            <c:choose>
              <c:when test="#{!empty itemBean.itemId}" >
                <f:param name="iid" value="#{itemBean.itemId}" />
              </c:when>
            </c:choose>
          </h:commandLink>
        </li>
      </c:when>
      <c:when test="#{((whichType == 'lend') or (whichType == 'both')) and (!empty itemBean.itemId)}"  >
        <li id="subs">
          <a href="#s1">Item Preferences/Conditions</a>
          <ul>
            <li id="tab_item_11">
              <c:set var="newItemLabel" value="Contact Preferences"  />
              <h:commandLink immediate="true"  action="#{contactPreferenceBean.load_ud(userBean.participant_id)}"  value="#{newItemLabel}"  >
                <f:param name="action" value="edit" />
                <c:choose>
                  <c:when test="#{!empty itemBean.itemId}" >
                    <f:param name="iid" value="#{itemBean.itemId}" />
                  </c:when>
                </c:choose>

              </h:commandLink>
            </li>
            <li id="tab_item_12" >
              <c:set var="newItemLabelTrans" value="Transfer Preferences"  />
              <h:commandLink  immediate="true" action="#{lenderTransferBean.load_ud(userBean.participant_id)}"  value="#{newItemLabelTrans}"  rendered="#{userBean.cpId}" > 
                <f:param name="action" value="edit" />
                <c:choose>
                  <c:when test="#{!empty itemBean.itemId}" >
                    <f:param name="iid" value="#{itemBean.itemId}" />
                  </c:when>
                </c:choose>
              </h:commandLink>   
            </li>
            <li id="tab_item_13" >
              <c:set var="newItemLabelCond" value="Lending Conditions"  />
              <h:commandLink  immediate="true" action="#{lenderItemConditionsBean.load_ud(userBean.participant_id)}"  value="#{newItemLabelCond}"  rendered="#{userBean.LITid}" >  
                <f:param name="action" value="edit" />
                <c:choose>
                  <c:when test="#{!empty itemBean.itemId}" >
                    <f:param name="iid" value="#{itemBean.itemId}" />
                  </c:when>
                </c:choose>
              </h:commandLink>   
            </li>
          </ul>
        </li>
      </c:when>     
    </c:choose>

    <c:choose>                                
      <c:when test="#{whichType == 'borrow'}"  >
        <li id="tab_item_15" >
          <c:set var="newItemLabel" value="Your Borrowing History"  />
          <h:commandLink immediate="true"  action="#{itemBean.getBorrowerHistory(userBean.participant_id, 0)}"  value="#{newItemLabel}"  rendered="true" >
          </h:commandLink>
        </li>
        <c:choose >
          <c:when  test="#{!empty userBean.communityId}" >
            <li id="tab_item_15" >
              <c:set var="newItemLabel" value="Your Community's Borrowing History"  />
              <h:commandLink  immediate="true" action="#{itemBean.getBorrowerHistory(userBean.communityId, 1)}"  value="#{newItemLabel}"  rendered="true">
              </h:commandLink>   
            </li>
          </c:when>         
        </c:choose>  
      </c:when>
      <c:when test="#{whichType == 'lend'}"  >
        <li id="tab_item_16">
          <c:set var="newItemLabel" value="Your Lending History"  />
          <h:commandLink immediate="true"  action="#{itemBean.getLenderHistory(userBean.participant_id, 0)}"  value="#{newItemLabel}"  rendered="true" >
          </h:commandLink>
        </li>
        <c:choose >
          <c:when  test="#{!empty userBean.communityId}"  >
            <li id="tab_item_16" >
              <c:set var="newItemLabel" value="Your Community's Lending History"  />
              <h:commandLink  immediate="true" action="#{itemBean.getLenderHistory(userBean.communityId, 1)}"  value="#{newItemLabel}"  rendered="true">
              </h:commandLink>   
            </li>
          </c:when>         
        </c:choose> 
      </c:when>
      <c:when test="#{whichType == 'both'}"  >
        <li id="subs">
          <a href="#s1">Your Lending or Borrowing History</a>
          <ul>
            <li id="tab_item_16">
              <c:set var="newItemLabel" value="Your Borrowing History"  />
              <h:commandLink immediate="true"  action="#{itemBean.getBorrowerHistory(userBean.participant_id, 0)}"  value="#{newItemLabel}"  rendered="true" >
              </h:commandLink>
            </li>
            <c:choose >
              <c:when  test="#{!empty userBean.communityId}"  >
                <li id="tab_item_16" >
                  <c:set var="newItemLabel" value="Your Community's Borrowing History"  />
                  <h:commandLink  immediate="true" action="#{itemBean.getBorrowerHistory(userBean.communityId, 1)}"  value="#{newItemLabel}"  rendered="true">
                  </h:commandLink>   
                </li>
              </c:when>         
            </c:choose> 



            <li id="tab_item_16">
              <c:set var="newItemLabel" value="Your Lending History"  />
              <h:commandLink immediate="true"  action="#{itemBean.getLenderHistory(userBean.participant_id, 0)}"  value="#{newItemLabel}"  rendered="true" >
              </h:commandLink>
            </li>
            <c:choose >
              <c:when  test="#{!empty userBean.communityId}"  >
                <li id="tab_item_16" >
                  <c:set var="newItemLabel" value="Your Community's Lending History"  />
                  <h:commandLink  immediate="true" action="#{itemBean.getLenderHistory(userBean.communityId, 1)}"  value="#{newItemLabel}"  rendered="true">
                  </h:commandLink>   
                </li>
              </c:when>         
            </c:choose> 
          </ul>
        </li>
      </c:when>
    </c:choose>

    <li >
      <h:commandLink action="#{userBean.clearItemId()}" immediate="true"  value="Return to DashBoard"  rendered="true" title="Default Preferences/Conditions or Add Another Item"  >
             
      </h:commandLink>
    </li>

  </ul>
</ui:composition>