<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
  <h:head>        
  </h:head>
  <c:set var="whichType" value="#{userBean.userIsWhichType()}" />
  <ul id="nav" class="item_menu">
    <li class="subs"  >
      <c:choose>                                
        <c:when test="#{whichType == 'borrow'}"  >
          <li id="tab_item_0" >
            <h:commandLink immediate="true"  action="#{itemBean.load_ud('borrow', userBean.itemId)}"  value="Item to Borrow"  rendered="true"    >
              <f:param name="action" value="item" />             
            </h:commandLink>
          </li>
        </c:when >  
        <c:when test="#{whichType == 'lend'}"  >
          <li id="tab_item_0" >
            <h:commandLink immediate="true"  action="#{itemBean.load_ud('lend',userBean.itemId)}"  value="Item to Lend"  rendered="true"    >
              <f:param name="action" value="item" />
            </h:commandLink>
          </li>
        </c:when >  
      </c:choose>
    </li>


    <c:choose>                                
      <c:when test="#{whichType == 'borrow'}"  >
        <li id="tab_item_1">
          <c:set var="newItemLabel" value="Item Contact Preferences"  />
          <h:commandLink immediate="true"  action="#{contactPreferenceBean.load_ud(userBean.participant_id)}"  value="#{newItemLabel}"  rendered="true" >
            <f:param name="action" value="edit" />
            <f:param name="iid" value="#{userBean.itemId}" />
          </h:commandLink>
        </li>
      </c:when>
      <c:when test="#{(whichType == 'lend') or (whichType == 'both')}"  >
        <li id="subs">
          <a href="#s1">Item Preferences/Conditions</a>
          <ul>
            <li id="tab_item_1">
              <c:set var="newItemLabel" value="Contact Preferences"  />
              <h:commandLink immediate="true"  action="#{contactPreferenceBean.load_ud(userBean.participant_id)}"  value="#{newItemLabel}"  rendered="true" >
                <f:param name="action" value="edit" />
                <f:param name="iid" value="#{userBean.itemId}" />
              </h:commandLink>
            </li>
            <li id="tab_item_2" >
              <c:set var="newItemLabelTrans" value="Transfer Preferences"  />
              <h:commandLink  immediate="true" action="#{lenderTransferBean.load_ud(userBean.participant_id)}"  value="#{newItemLabelTrans}"  rendered="true">
                <f:param name="iid" value="#{userBean.itemId}" />
                <f:param name="action" value="edit" />
              </h:commandLink>   
            </li>
            <li id="tab_item_3" >
              <c:set var="newItemLabelCond" value="Lending Conditions"  />
              <h:commandLink  immediate="true" action="#{lenderItemConditionsBean.load_ud(userBean.participant_id)}"  value="#{newItemLabelCond}"  rendered="true">
                <f:param name="iid" value="#{userBean.itemId}" />
                <f:param name="action" value="edit" />
              </h:commandLink>   
            </li>
          </ul>
        </li>
      </c:when>     
    </c:choose>

    <li id="tab_item_10" >
      <h:commandLink immediate="true"  action="#{itemBean.load_ud(whichType, null)}"  value="Add Another Item"  rendered="true"    >
        <f:param name="action" value="item" />             
      </h:commandLink>
    </li>

    <c:choose>                                
      <c:when test="#{whichType == 'borrow'}"  >
        <li id="tab_item_11">
          <c:set var="newItemLabel" value="Your Borrowing History"  />
          <h:commandLink immediate="true"  action="#{itemBean.getBorrowerHistory(userBean.participant_id, 0)}"  value="#{newItemLabel}"  rendered="true" >
          </h:commandLink>
        </li>
        <c:choose >
          <c:when  test="#{!empty userBean.communityId}" >
            <li id="tab_item_12" >
              <c:set var="newItemLabel" value="Your Community's Borrowing History"  />
              <h:commandLink  immediate="true" action="#{itemBean.getBorrowerHistory(userBean.communityId, 1)}"  value="#{newItemLabel}"  rendered="true">
              </h:commandLink>   
            </li>
          </c:when>         
        </c:choose>  
      </c:when>
      <c:when test="#{whichType == 'lend'}"  >
        <li id="tab_item_11">
          <c:set var="newItemLabel" value="Your Lending History"  />
          <h:commandLink immediate="true"  action="#{itemBean.getLenderHistory(userBean.participant_id, 0)}"  value="#{newItemLabel}"  rendered="true" >
          </h:commandLink>
        </li>
        <c:choose >
          <c:when  test="#{!empty userBean.communityId}"  >
            <li id="tab_item_12" >
              <c:set var="newItemLabel" value="Your Community's Lending History"  />
              <h:commandLink  immediate="true" action="#{itemBean.getLenderHistory(userBean.communityId, 1)}"  value="#{newItemLabel}"  rendered="true">
              </h:commandLink>   
            </li>
          </c:when>         
        </c:choose> 
      </c:when>
    </c:choose>

    <li id="tab_item_4" >
      <h:commandLink immediate="true"  value="Return to..."  rendered="true"    >
      </h:commandLink>
    </li>

  </ul>

</ui:composition>